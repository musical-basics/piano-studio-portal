{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/lionelyu/Documents/New%20Version/piano-studio-prototype/components/admin-dashboard.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AdminDashboard = registerClientReference(\n    function() { throw new Error(\"Attempted to call AdminDashboard() from the server but AdminDashboard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/admin-dashboard.tsx <module evaluation>\",\n    \"AdminDashboard\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,iBAAiB,IAAA,uYAAuB,EACjD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,gEACA","ignoreList":[0]}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/lionelyu/Documents/New%20Version/piano-studio-prototype/components/admin-dashboard.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AdminDashboard = registerClientReference(\n    function() { throw new Error(\"Attempted to call AdminDashboard() from the server but AdminDashboard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/admin-dashboard.tsx\",\n    \"AdminDashboard\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,iBAAiB,IAAA,uYAAuB,EACjD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,4CACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///Users/lionelyu/Documents/New%20Version/piano-studio-prototype/app/admin/page.tsx"],"sourcesContent":["import { redirect } from \"next/navigation\"\nimport { createClient } from \"@/lib/supabase/server\"\nimport { AdminDashboard } from \"@/components/admin-dashboard\"\nimport type { TodayLesson, StudentRoster, LessonWithStudent } from \"@/components/admin-dashboard\"\n\nexport default async function AdminPage() {\n  const supabase = await createClient()\n\n  // Check authentication\n  const { data: { user }, error: authError } = await supabase.auth.getUser()\n\n  if (authError || !user) {\n    redirect(\"/login\")\n  }\n\n  // Fetch admin profile and verify role\n  const { data: profile, error: profileError } = await supabase\n    .from(\"profiles\")\n    .select(\"*\")\n    .eq(\"id\", user.id)\n    .single()\n\n  if (profileError || !profile) {\n    console.error(\"Profile fetch error:\", profileError)\n    redirect(\"/login\")\n  }\n\n  // Role check: Only admins can access this page\n  if (profile.role !== 'admin') {\n    redirect(\"/student\")\n  }\n\n  // Fetch today's lessons with student profiles\n  const today = new Date().toISOString().split('T')[0]\n\n  const { data: todaysLessonsRaw, error: lessonsError } = await supabase\n    .from(\"lessons\")\n    .select(`\n            *,\n            student:profiles!lessons_student_id_fkey(*)\n        `)\n    .eq(\"date\", today)\n    .eq(\"status\", \"scheduled\")\n    .order(\"time\", { ascending: true })\n\n  if (lessonsError) {\n    console.error(\"Lessons fetch error:\", lessonsError)\n  }\n\n  // Transform lessons data for the component\n  const todaysLessons: TodayLesson[] = (todaysLessonsRaw || []).map(lesson => ({\n    ...lesson,\n    student: lesson.student\n  }))\n\n  // Fetch all scheduled lessons (future, including today)\n  const { data: scheduledLessonsRaw } = await supabase\n    .from(\"lessons\")\n    .select(`\n            *,\n            student:profiles!lessons_student_id_fkey(*)\n        `)\n    .eq(\"status\", \"scheduled\")\n    .gte(\"date\", today)\n    .order(\"date\", { ascending: true })\n    .order(\"time\", { ascending: true })\n\n  const scheduledLessons: LessonWithStudent[] = (scheduledLessonsRaw || []).map(lesson => ({\n    ...lesson,\n    student: lesson.student\n  }))\n\n  // Fetch all completed lessons\n  const { data: completedLessonsRaw } = await supabase\n    .from(\"lessons\")\n    .select(`\n            *,\n            student:profiles!lessons_student_id_fkey(*)\n        `)\n    .eq(\"status\", \"completed\")\n    .order(\"date\", { ascending: false })\n    .order(\"time\", { ascending: false })\n    .limit(50)\n\n  const completedLessons: LessonWithStudent[] = (completedLessonsRaw || []).map(lesson => ({\n    ...lesson,\n    student: lesson.student\n  }))\n\n  // Fetch all students (profiles with role = 'student')\n  const { data: studentsRaw, error: studentsError } = await supabase\n    .from(\"profiles\")\n    .select(\"*\")\n    .eq(\"role\", \"student\")\n    .order(\"name\", { ascending: true })\n\n  if (studentsError) {\n    console.error(\"Students fetch error:\", studentsError)\n  }\n\n  const students: StudentRoster[] = studentsRaw || []\n\n  // Count unread messages (messages where admin is recipient and is_read is false)\n  const totalUnread = 0\n\n  return (\n    <AdminDashboard\n      admin={profile}\n      todaysLessons={todaysLessons}\n      scheduledLessons={scheduledLessons}\n      completedLessons={completedLessons}\n      students={students}\n      totalUnread={totalUnread}\n    />\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;AACA;;;;;AAGe,eAAe;IAC5B,MAAM,WAAW,MAAM,IAAA,yIAAY;IAEnC,uBAAuB;IACvB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAExE,IAAI,aAAa,CAAC,MAAM;QACtB,IAAA,gUAAQ,EAAC;IACX;IAEA,sCAAsC;IACtC,MAAM,EAAE,MAAM,OAAO,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SAClD,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;IAET,IAAI,gBAAgB,CAAC,SAAS;QAC5B,QAAQ,KAAK,CAAC,wBAAwB;QACtC,IAAA,gUAAQ,EAAC;IACX;IAEA,+CAA+C;IAC/C,IAAI,QAAQ,IAAI,KAAK,SAAS;QAC5B,IAAA,gUAAQ,EAAC;IACX;IAEA,8CAA8C;IAC9C,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IAEpD,MAAM,EAAE,MAAM,gBAAgB,EAAE,OAAO,YAAY,EAAE,GAAG,MAAM,SAC3D,IAAI,CAAC,WACL,MAAM,CAAC,CAAC;;;QAGL,CAAC,EACJ,EAAE,CAAC,QAAQ,OACX,EAAE,CAAC,UAAU,aACb,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAK;IAEnC,IAAI,cAAc;QAChB,QAAQ,KAAK,CAAC,wBAAwB;IACxC;IAEA,2CAA2C;IAC3C,MAAM,gBAA+B,CAAC,oBAAoB,EAAE,EAAE,GAAG,CAAC,CAAA,SAAU,CAAC;YAC3E,GAAG,MAAM;YACT,SAAS,OAAO,OAAO;QACzB,CAAC;IAED,wDAAwD;IACxD,MAAM,EAAE,MAAM,mBAAmB,EAAE,GAAG,MAAM,SACzC,IAAI,CAAC,WACL,MAAM,CAAC,CAAC;;;QAGL,CAAC,EACJ,EAAE,CAAC,UAAU,aACb,GAAG,CAAC,QAAQ,OACZ,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAK,GAChC,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAK;IAEnC,MAAM,mBAAwC,CAAC,uBAAuB,EAAE,EAAE,GAAG,CAAC,CAAA,SAAU,CAAC;YACvF,GAAG,MAAM;YACT,SAAS,OAAO,OAAO;QACzB,CAAC;IAED,8BAA8B;IAC9B,MAAM,EAAE,MAAM,mBAAmB,EAAE,GAAG,MAAM,SACzC,IAAI,CAAC,WACL,MAAM,CAAC,CAAC;;;QAGL,CAAC,EACJ,EAAE,CAAC,UAAU,aACb,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAM,GACjC,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAM,GACjC,KAAK,CAAC;IAET,MAAM,mBAAwC,CAAC,uBAAuB,EAAE,EAAE,GAAG,CAAC,CAAA,SAAU,CAAC;YACvF,GAAG,MAAM;YACT,SAAS,OAAO,OAAO;QACzB,CAAC;IAED,sDAAsD;IACtD,MAAM,EAAE,MAAM,WAAW,EAAE,OAAO,aAAa,EAAE,GAAG,MAAM,SACvD,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,QAAQ,WACX,KAAK,CAAC,QAAQ;QAAE,WAAW;IAAK;IAEnC,IAAI,eAAe;QACjB,QAAQ,KAAK,CAAC,yBAAyB;IACzC;IAEA,MAAM,WAA4B,eAAe,EAAE;IAEnD,iFAAiF;IACjF,MAAM,cAAc;IAEpB,qBACE,6WAAC,mJAAc;QACb,OAAO;QACP,eAAe;QACf,kBAAkB;QAClB,kBAAkB;QAClB,UAAU;QACV,aAAa;;;;;;AAGnB"}}]
}